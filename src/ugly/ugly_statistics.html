<html>

<head>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>

    <script src="js/quizas_auth_helper.js"></script>
</head>

<body>
<h3>Statistics Dummy page</h3>



<b>User ID: </b>
<div id="user_id"></div>
<br/><br/>

<script>
var user_id = quizas_user_id();
$("#user_id").text(user_id);
</script>



<b>Stats of user</b>
<em>/user/#user-id/stats</em><br>
<div id="stats_result"></div>
<br/><br/>

<script>
$.get("/api/user/" + user_id + "/stats", function (data) {
    $("#stats_result").text(data);
});
</script>



<b>Stats of user</b>
<em>/user/#user-id/stats/games</em><br>
<div id="stats_games"></div>
<br/><br/>

<script>
$.get("/api/user/" + user_id + "/stats/games", function (data) {
    $("#stats_games").text(data);

    // Call on for-each game.
    var response = JSON.parse(data);
    response.forEach(function (gameId) {
        outputStatsForGame(gameId);
    });
});
</script>



<b>Stats for each Game</b>
<em>/user/#user-id/stats/game/#gameid</em><br>
<div id="stats_for_games"></div>
<br/><br/>

<script>
function outputStatsForGame(gameId) {
    $.get("/api/user/" + user_id + "/stats/game/" + gameId, function (data) {
        var gameDivId = gameId + "_stats";
        
        $("<div/>", {
            "id": gameDivId
        }).appendTo("#stats_for_games");

        $("#" + gameDivId).text(data);
    });
}
</script>



<b>Stats for each Flashset</b>
<em>/user/#user-id/stats/sets/#setid</em><br>
<div id="stats_for_flashsets"></div>
<br/><br/>

<script>
function quizasId(i) {
    return i.replace(":", "_");
}

function outputStatsForSet(setId) {
    $.get("/api/user/" + user_id + "/stats/sets/" + setId, function (data) {
        // n.b. need to replace : with _
        var setDivId = quizasId(setId) + "_stats";
        
        $("<div/>", {
            "id": setDivId
        }).appendTo("#stats_for_flashsets");

        $("#" + setDivId).text(data);
    });
}

// B/c I'm too lazy to filter through all games
// to find unique flashsets
// I guess best to get all sets; only visualise the ones
// which have been studied.
var flashsetId = "quizlet:57054880";
outputStatsForSet(flashsetId);
</script>

<script>
</script>



<b>Stats for each Friend played against</b>
<em>/user/#user-id/stats/sets/#setid</em><br>
<div id="stats_for_flashsets">
lol, no.
</div>
<br/><br/>



<h2>Graphs</h2>

<!-- Need D3, from CDN; and need d3pie.min.js in the js/ folder.

GitHub is *not* a CDN. But in case you need to know where
to download d3pie.min.js from:
https://raw.githubusercontent.com/benkeen/d3pie/0.1.3/d3pie/d3pie.min.js
-->
<script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.4/d3.min.js"></script>
<script src="js/d3pie.min.js"></script>



<div id="overallStatsPieChart"></div>
<br/><br/>

<script>
function outputWinLossDrawPieChart(statsObj) {
    // outputs to "#overallStatsPieChart"
    var numWins = statsObj.wins;
    var numLosses = statsObj.losses;
    var numDraws = statsObj.draws;

    // Yes, you need all these details. Even if you're
    // not going to have subtitles, etc.
    var pieChartData = {
        "header": {
            "title": {
                "text": "Overall Results",
                    "fontSize": 22,
                    "font": "verdana"
            },
            "subtitle": {
                "color": "#999999",
                "fontSize": 10,
                "font": "verdana"
            },
            "titleSubtitlePadding": 12
        },
        "footer": {
            "color": "#999999",
            "fontSize": 11,
            "font": "open sans",
            "location": "bottom-center"
        },
        "size": {
            "canvasHeight": 400,
            "canvasWidth": 590
        },
        "labels": {
            "outer": {
                "pieDistance": 32
            },
            "inner": {
                "format": "value"
            },
            "mainLabel": {
                "font": "verdana"
            },
            "percentage": {
                "color": "#e1e1e1",
                "font": "verdana",
                "decimalPlaces": 0
            },
            "value": {
                "color": "#e1e1e1",
                "font": "verdana"
            },
            "lines": {
                "enabled": true,
                "color": "#cccccc"
            }
        },
        "effects": {
            "load": {
                "effect": "none"
            },
            "pullOutSegmentOnClick": {
                "effect": "none",
                "speed": 400,
                "size": 8
            },
            "highlightSegmentOnMouseover": false
        }
    };

    pieChartData.data = {
        "content": [
        {
            "label": "Wins",
                "value": numWins,
                "color": "#389e38"
        },
        {
            "label": "Draws",
            "value": numLosses,
            "color": "#383838"
        },
        {
            "label": "Losses",
            "value": numDraws,
            "color": "#7c3838"
        }]
    };

    var pie = new d3pie("overallStatsPieChart", pieChartData);
}

outputWinLossDrawPieChart({wins: 3, draws: 2, losses: 1});
</script>



<b>Line Chart of a Game</b><br/>
This could be useful for post-game stats.


</body>

</html>
